<div id='pp-select-container' class='clearfix'>
  <div id='left_actions'>
    
    <div class="controls">
      <%= link_to "Reorder menu items", refinery.edit_admin_page_menu_path(@page_menu),
                  :id => "reorder_action",
                  :class => "reorder_icon" %>

      <%= link_to "Done reordering menu items", refinery.edit_admin_page_menu_path(@page_menu),
                  :id => "reorder_action_done",
                  :style => "display: none;",
                  :class => "reorder_icon" %>
    </div>
    
    <div id="custom_url_box" class="pp-add-box">
      <h3>Custom Link</h3>
      <div class='field'>
        <%= label_tag(:url) %>
        <%= text_field_tag(:url) %>
      </div>
      <div class='field'>
        <%= label_tag(:label) %>
        <%= text_field_tag(:label) %>
      </div>
      <a href="#" class="button add_link">Add</a>
    </div>

    <% Refinery::PageMenus.menu_resources.each do |resource_type, config| %>
      <%= render partial: "refinery/admin/page_positions/resource_link_editor_box", locals: {resource_type: resource_type, config: config} %>
    <% end %>

  </div>

  <%= content_tag :ul, id: "sortable_list", data: {links: @page_positions} do %>
    <%#= hidden_field_tag "ul" %>
    <% if @page_positions.present? %>
      <%= f.fields_for :positions, @page_positions.select{|p| p.parent_id.nil?} do |position_form|  %>
        <%= render 'refinery/admin/page_positions/page_position', pf: position_form, f: f %>
      <% end %>
    <% else %>
      <li class='placeholder-text'>Use the left side to add links to your menu.</li>
    <% end %>
  <% end %>


</div>


<% content_for :javascripts, javascript_include_tag('refinery/menu_editor') %>

<% content_for :stylesheets, stylesheet_link_tag('refinery/select_form') %>


<%= render '/refinery/admin/make_sortable', :update_url => refinery.update_positions_admin_page_menu_page_positions_path(@page_menu.id || 0), :tree => true%>

<%= render '/refinery/admin/sortable_list', :continue_reordering => !!local_assigns[:continue_reordering] %>

<% content_for :javascripts, javascript_include_tag('refinery/backend') %>